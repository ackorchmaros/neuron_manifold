################################ FIG 10 ################################
# author:Annachiara Korchmaros
# comments: Eigenspectrum decay for Segres with cvPCA and cvPCA with shuffling


################################ Eigenspectrum decay with permutation test for Segres with 2 repeats and cvPCA method for variances  ################################
# author:Annachiara Korchmaros
# first update: 2.2.2021 Aalto
# last update: 6.2.2021 Aalto
# figure 3 paper

/////////////////// case 10000 ambient space dimension with 10 vector means
# sample 3000 from a segre variety of dimension 199 in a space of 1000
Rscript --vanilla /Users/korchma1/Desktop/dimensionality/scripts/sample_segre_cases_100Adim_non0mean.R 10000 3000 '~/Desktop/dimensionality/data/segre' 10 

# add noise to the sample to create 2 repeats

Rscript --vanilla /Users/korchma1/Desktop/dimensionality/scripts/add_noise2segre.R 10000 3000 '~/Desktop/dimensionality/data/segre' 10 750 // correlation 0.21

#make plots
// no permutations
open /Users/korchma1/Desktop/dimensionality/scripts/stringer-pachitariu-et-al-2018b-master/process_data_segre_ak.m 
segre_case='10000ambient_3000sample_199segre'
plot option:orded_fig2_segre_ak

// permutation columns
open /Users/korchma1/Desktop/dimensionality/scripts/stringer-pachitariu-et-al-2018b-master/process_data_segre_2repeats_permute_col_ak.m 
segre_case='10000ambient_3000sample_199segre'